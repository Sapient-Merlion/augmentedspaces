'use strict';

import 'babel-polyfill';
import 'jquery';
import 'magnific-popup';
import anime from 'animejs';
import CanvasAnimate from './components/canvasAnimate';

import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo1.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo2.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo3.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo4.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo5.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo6.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo7.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo8.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo9.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo10.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo11.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo12.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo13.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo14.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo15.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo16.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo17.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo18.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo19.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo20.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo21.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo22.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo23.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo24.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo25.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo26.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo27.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo28.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo29.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo30.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo31.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo32.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo33.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo34.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo35.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo36.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo37.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo38.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo39.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo40.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo41.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo42.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo43.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo44.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo45.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo46.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo47.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo48.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo49.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo50.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo51.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo52.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo53.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo54.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo55.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo56.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo57.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo58.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo59.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo60.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo61.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo62.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo63.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo64.jpg';
import '!!file-loader?name=images/2019/[name].[ext]!images/2019/photo65.jpg';

import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo1.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo2.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo3.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo4.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo5.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo6.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo7.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo8.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo9.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo10.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo11.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo12.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo13.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo14.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo15.jpg';
import '!!file-loader?name=images/2018/[name].[ext]!images/2018/photo16.jpg';

function importAll(r) {
  return r.keys().map(r);
}

const images = importAll(require.context('../images/gallery/', false, /\.(png|jpe?g|svg)$/));
const svgs = importAll(require.context('../icons/', false, /.*\.svg$/));
import '../styles/style.scss';

//bind plugin definition to jQuery
window.jQuery = $;
window.$ = $;

CanvasAnimate();

function initTabs() {
  $('.tabs').each(function() {
    $(this)
      .find('li')
      .each(function() {
        $(this)
          .find('a')
          .on('click', function(evt) {
            evt.preventDefault();
            $('.tabs')
              .find('li')
              .removeClass('selected');
            $(this)
              .parent()
              .addClass('selected');
            const panelID = $(this).attr('href');
            $('.tab-panel').hide();
            $(panelID).show();
            $(panelID).css({
              opacity: 0
            });
            anime({
              targets: panelID,
              opacity: 1,
              easing: 'easeOutCubic',
              duration: 350
            });
            initViewall();
          });
      });
  });
  $('.tab-panel').hide();
  $('.tab-panel')
    .first()
    .show();
  $('.tabs')
    .find('li')
    .first()
    .addClass('selected');
}

function initViewall() {
  let initialShow = 12;
  if (getBootstrapDeviceSize() === 'sm') {
    initialShow = 9;
  } else if (getBootstrapDeviceSize() === 'xs') {
    initialShow = 6;
  }

  $('.galleryphotos').removeAttr('style');
  $('.galleryphotos').each(function() {
    const galleryContainer = $(this);
    galleryContainer
      .next()
      .find('.showall')
      .show();

    // check if total photo lesser that the initial show value
    if (initialShow >= galleryContainer.find('.photothumb').length) {
      galleryContainer
        .next()
        .find('.showall')
        .hide();
    }

    galleryContainer.find('.photothumb').each(function(i) {
      if (i > initialShow - 1) {
        $(this)
          .parent()
          .removeAttr('style');
      }
    });

    galleryContainer.attr('data-origheight', galleryContainer.outerHeight());

    galleryContainer.find('.photothumb').each(function(i) {
      if (i > initialShow - 1) {
        $(this)
          .parent()
          .css({
            display: 'none'
          });
      }
    });

    const shortenheight = $(this).outerHeight();
    galleryContainer.css({
      height: shortenheight
    });

    galleryContainer.find('.photothumb').each(function(i) {
      if (i > initialShow - 1) {
        $(this)
          .parent()
          .removeAttr('style');
      }
    });

    galleryContainer
      .next()
      .find('.showall')
      .off()
      .on('click', function() {
        const totalHeight = galleryContainer.data('origheight');
        anime({
          targets: '.galleryphotos',
          height: totalHeight,
          easing: 'easeOutCubic',
          duration: 350
        });
        $(this).hide();
      });
  });
}

function getBootstrapDeviceSize() {
  return $('#users-device-size')
    .find('div:visible')
    .first()
    .attr('id');
}

$(() => {
  window.onresize = () => {
    initViewall();
  };

  $('.menuclick').on('click', function() {
    $('body').addClass('expand');
    $('#bottom-menu').hide();
    initViewall();
  });

  $('.close-menu').on('click', function() {
    $('body').removeClass('expand');
    $('#bottom-menu').show();
  });

  $('.photothumb').magnificPopup({
    type: 'image',
    closeOnContentClick: true,
    closeBtnInside: false,
    mainClass: 'mfp-no-margins mfp-with-zoom', // class to remove default margin from left and right side
    image: {
      verticalFit: true
    },
    gallery: {
      enabled: true
    },
    zoom: {
      enabled: true,
      duration: 300 // don't foget to change the duration also in CSS
    }
  });

  if (window.location.hash.slice(1) === 'gallery') {
    $('.menuclick').trigger('click');
    setTimeout(function() {
      $('.bottom-drawer').animate(
        {
          scrollTop: $('.anchor-gallery').offset().top
        },
        500
      );
    }, 800);
  }

  initTabs();
  initViewall();
  window.dispatchEvent(new Event('resize'));
});
